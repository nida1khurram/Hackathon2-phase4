(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{1651:function(t,e,n){Promise.resolve().then(n.t.bind(n,4811,23)),Promise.resolve().then(n.t.bind(n,2778,23)),Promise.resolve().then(n.bind(n,8847))},9376:function(t,e,n){"use strict";var o=n(5475);n.o(o,"useRouter")&&n.d(e,{useRouter:function(){return o.useRouter}})},8847:function(t,e,n){"use strict";n.d(e,{Providers:function(){return a}});var o=n(7437);n(2265);var r=n(7206);function a(t){let{children:e}=t;return(0,o.jsx)(r.H,{children:e})}},7206:function(t,e,n){"use strict";n.d(e,{H:function(){return l},a:function(){return u}});var o=n(7437),r=n(2265),a=n(9376);let i=(0,r.createContext)(void 0);function l(t){let{children:e}=t,[l,u]=(0,r.useState)(null),[s,c]=(0,r.useState)(!0),h=(0,a.useRouter)();(0,r.useEffect)(()=>{localStorage.getItem("auth_token")?g():c(!1)},[]);let f=async(t,e)=>{try{let n=await fetch("".concat("http://localhost:8001","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:e})});if(n.ok){let t=await n.json();localStorage.setItem("auth_token",t.access_token),u(t.user),h.push("/tasks")}else{let t=await n.json();throw Error(t.detail||"Login failed")}}catch(t){throw t}},d=async(t,e)=>{try{let n=await fetch("".concat("http://localhost:8001","/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:e})});if(n.ok)h.push("/login");else{let t=await n.json();throw Error(t.detail||"Registration failed")}}catch(t){throw t}},_=async()=>{let{authAPI:t}=await n.e(898).then(n.bind(n,6898));await t.logout(),u(null),h.push("/login")},g=async()=>{try{c(!0);let t=localStorage.getItem("auth_token");if(!t)return u(null),!1;let e=await fetch("".concat("http://localhost:8001","/auth/me"),{headers:{Authorization:"Bearer ".concat(t)}});if(!e.ok)return localStorage.removeItem("auth_token"),u(null),"/login"!==window.location.pathname&&h.push("/login"),!1;{let t=await e.json();return u(t),!0}}catch(t){return console.error("Error verifying user:",t),localStorage.removeItem("auth_token"),u(null),"/login"!==window.location.pathname&&h.push("/login"),!1}finally{c(!1)}};return(0,o.jsx)(i.Provider,{value:{user:l,loading:s,login:f,logout:_,register:d,verifyUser:g,isAuthenticated:!!l},children:e})}function u(){let t=(0,r.useContext)(i);if(void 0===t)throw Error("useAuth must be used within an AuthProvider");return t}},2778:function(){},4811:function(t){t.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}}},function(t){t.O(0,[2,971,117,744],function(){return t(t.s=1651)}),_N_E=t.O()}]);